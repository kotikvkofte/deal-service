# Deal Service

–°–µ—Ä–≤–∏—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–º–∏ —Å–¥–µ–ª–∫–∞–º–∏ (–¥–æ–≥–æ–≤–æ—Ä–∞–º–∏, —Å—É–º–º–∞–º–∏, –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞–º–∏ –∏ –∏—Ö —Ä–æ–ª—è–º–∏), —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Ñ–∏–ª—å—Ç—Ä–æ–≤, —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏, –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ –∏ —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤ Excel.

---

## üìÜ –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

* ‚úÖ CRUD –¥–ª—è —Å—É—â–Ω–æ—Å—Ç–∏ `–°–¥–µ–ª–∫–∞`
* ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞–º–∏ –∏ –∏—Ö —Ä–æ–ª—è–º–∏
* ‚úÖ –ü–æ–∏—Å–∫ —Å–¥–µ–ª–æ–∫ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –∏ –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π
* ‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ —Å–¥–µ–ª–∫–∏
* ‚úÖ –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel (—Å —Ü–≤–µ—Ç–æ–º –∏ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–æ–π)
* ‚úÖ –õ–æ–≥–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ `is_active`
* ‚úÖ Liquibase –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–π

---

## üöÄ –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

| –°—Ç–µ–∫              | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ     |
| ----------------- | ---------------- |
| Java              | 17+              |
| Spring Boot       | 3.x              |
| Spring Data JPA   | PostgreSQL       |
| Hibernate         | 6.x              |
| Liquibase         | –ú–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã    |
| Apache POI        | –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel  |
| Swagger (OpenAPI) | –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API |
| Lombok            | –£–ø—Ä–æ—â–µ–Ω–∏–µ –∫–æ–¥–∞   |
| Maven             | –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞   |

---

## üìÖ API –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã

### –°–¥–µ–ª–∫–∏

| Method | URI                   | Description               |
| ------ | --------------------- | ------------------------- |
| PUT    | `/deal/save`          | –°–æ–∑–¥–∞—Ç—å / –æ–±–Ω–æ–≤–∏—Ç—å —Å–¥–µ–ª–∫—É |
| PATCH  | `/deal/change/status` | –ò–∑–º–µ–Ω–∏—Ç—å —Å—Ç–∞—Ç—É—Å —Å–¥–µ–ª–∫–∏    |
| GET    | `/deal/deal/{id}`     | –ü–æ–ª—É—á–∏—Ç—å —Å–¥–µ–ª–∫—É –ø–æ ID     |
| POST   | `/deal/search`        | –ü–æ–∏—Å–∫ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π       |
| POST   | `/deal/search/export` | üìÑ –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel        |

### –ö–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç—ã

| Method | URI                            | Description            |
| ------ | ------------------------------ | ---------------------- |
| PUT    | `/deal-contractor/save`        | –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞ |
| DELETE | `/deal-contractor/delete/{id}` | –õ–æ–≥–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ    |

### –†–æ–ª–∏ –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–æ–≤

| Method | URI                          | Description               |
| ------ | ---------------------------- |---------------------------|
| POST   | `/contractor-to-role/add`    | –î–æ–±–∞–≤–∏—Ç—å —Ä–æ–ª—å –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç—É |
| DELETE | `/contractor-to-role/delete` | –õ–æ–≥–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ       |

---

## üìÑ –ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ —ç–∫—Å–ø–æ—Ä—Ç Excel

```json
POST /deal/search/export
Content-Type: application/json
Accept: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet

{
  "page": 0,
  "size": 20,
  "sortBy": "agreementDate",
  "sortDirection": "DESC",
  "description": "–∫—Ä–µ–¥–∏—Ç"
}
```

–†–µ–∑—É–ª—å—Ç–∞—Ç: Excel-—Ñ–∞–π–ª `.xlsx` —Å —Å–¥–µ–ª–∫–∞–º–∏.
![img.png](img.png)
---

## üìÅ Liquibase

–ú–∏–≥—Ä–∞—Ü–∏–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤:

```
src/main/resources/db/changelog/
```

---

## ‚ö†Ô∏è –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

```json
{
  "message": "Deal with id '...' not found",
  "timestamp": "2025-07-14T14:00:00"
}
```
---

## üí° –°—Ç–∞—Ä—Ç –ª–æ–∫–∞–ª—å–Ω–æ —Å Docker

1. –°–æ–∑–¥–∞—Ç—å `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:

```env
DB_NAME=deal-service-db
DB_USER=user
DB_PASSWORD=1
```
2. –°—Ç–∞—Ä—Ç:
```bash
docker compose up --build
```

---

## üë§ –ê–≤—Ç–æ—Ä

**–ö—Ä–∞–∫–æ–≤—Ü–µ–≤ –ê—Ä—Ç—ë–º**
